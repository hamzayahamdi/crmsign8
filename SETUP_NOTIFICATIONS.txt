ğŸ”” NOTIFICATION SYSTEM - SETUP & TEST INSTRUCTIONS
==================================================

âœ… STEP 1: Generate Prisma Client
----------------------------------
Run this command to generate the Prisma client with the new Notification model:

  npx prisma generate


âœ… STEP 2: Run Database Migration
----------------------------------
Create the notifications table in your database:

  npx prisma migrate dev --name add_notifications_system

OR if you prefer to push directly:

  npx prisma db push


âœ… STEP 3: Enable Supabase Realtime (IMPORTANT!)
-------------------------------------------------
1. Go to your Supabase Dashboard
2. Navigate to: Database â†’ Replication
3. Find the "notifications" table
4. Click to enable replication
5. Make sure INSERT, UPDATE, DELETE events are enabled


âœ… STEP 4: Create Test Notifications
-------------------------------------
Run this command to create sample notifications:

  npm run test:notifications

This will create 8 notifications per user:
- 5 unread notifications (high/medium priority)
- 3 read notifications
- Different types: RDV, payments, devis, tasks, etc.


âœ… STEP 5: Start the App & Test
--------------------------------
1. Start the development server:
   npm run dev

2. Login to the app

3. Look for these features:
   âœ“ Bell icon in top-right header (with badge count)
   âœ“ "Notifications" in sidebar menu (with badge)
   âœ“ Click bell to see dropdown with recent notifications
   âœ“ Click "Notifications" in sidebar to see full page

4. Test the features:
   âœ“ Click a notification to mark it as read
   âœ“ Click "Tout marquer comme lu" to mark all as read
   âœ“ Filter by "Non lues" to see only unread
   âœ“ Filter by type (RDV, Devis, etc.)
   âœ“ Delete notifications with trash icon
   âœ“ Check that badges update in realtime


ğŸ¯ WHAT YOU SHOULD SEE
-----------------------
âœ“ Bell icon with badge showing unread count
âœ“ Sidebar "Notifications" with badge
âœ“ Notifications grouped by date (Aujourd'hui, Hier, etc.)
âœ“ Different colored icons for different notification types
âœ“ Blue dot on unread notifications
âœ“ Smooth animations when interacting


ğŸ”§ TROUBLESHOOTING
-------------------
âŒ "Property 'notification' does not exist"
   â†’ Run: npx prisma generate

âŒ No notifications showing
   â†’ Run: npm run test:notifications
   â†’ Check that you're logged in
   â†’ Check browser console for errors

âŒ Realtime not working
   â†’ Enable Supabase replication (Step 3)
   â†’ Check .env has NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY
   â†’ Check browser console for connection errors

âŒ Sidebar not showing on notifications page
   â†’ Clear browser cache and refresh
   â†’ Check that AuthGuard is working


ğŸ“ CREATE NOTIFICATIONS IN YOUR CODE
-------------------------------------
Example: Notify user when RDV is created

import { notifyRdvCreated } from '@/lib/notification-creator';

await notifyRdvCreated({
  userId: 'user-id',
  clientName: 'Ahmed Test',
  clientId: 'client-id',
  appointmentDate: '12 nov Ã  08h00',
  location: 'Rabat',
  createdBy: 'admin-id'
});


ğŸ“š AVAILABLE NOTIFICATION CREATORS
-----------------------------------
- notifyRdvCreated()        â†’ New appointment
- notifyRdvReminder()       â†’ Appointment reminder
- notifyDevisCreated()      â†’ New quote
- notifyStageChanged()      â†’ Client stage update
- notifyPaymentReceived()   â†’ Payment confirmed
- notifyTaskAssigned()      â†’ New task
- notifyTaskDueSoon()       â†’ Task deadline approaching
- notifyDocumentUploaded()  â†’ New document
- notifyClientAssigned()    â†’ New client assigned

All functions are in: lib/notification-creator.ts


ğŸ¨ CUSTOMIZATION
-----------------
- Icons & colors: lib/notification-utils.ts
- Toast behavior: contexts/notification-context.tsx
- UI styling: components/notification-bell.tsx
- Page layout: app/notifications/page.tsx


âœ¨ THAT'S IT!
--------------
Your notification system is now ready to use!

The system includes:
âœ“ Real-time updates via Supabase
âœ“ Smart contextual toasts
âœ“ Beautiful UI with calm design
âœ“ Full notification history
âœ“ Priority-based filtering
âœ“ Date grouping
âœ“ Mark as read/unread
âœ“ Delete notifications

Happy coding! ğŸ‰
